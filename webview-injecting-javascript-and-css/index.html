<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha256-k2WSCIexGzOj3Euiig+TlR8gA0EmPjuc79OEeY5L45g=" crossorigin="anonymous"></script>
  </head>

  <body>
    <p>
       <span>Selector Assistant</span>
       <form onsubmit="event.preventDefault(); handleFormSubmission();">
          <input type="text" id="selectorForAssistant" />
          <input type="submit" value="Submit" />
       </form>
    </p>
    <webview id="webview" src="http://bigbinary-website-stagi-pr-705.herokuapp.com/san-francisco" style="position:absolute;width:100%;height:100%;" preload="./preload.js"></webview>
    <h1 class="indicator"></h1>
  </body>

   <script>
   let handleFormSubmission;

  onload = () => {

    const webview = document.querySelector('webview')
    const indicator = document.querySelector('.indicator')

    const loadstart = () => { indicator.innerText = 'loading...' }
    const loadstop = () => { indicator.innerText = '' }
    webview.addEventListener('did-start-loading', loadstart)
    webview.addEventListener('did-stop-loading', loadstop)

    webview.addEventListener('ipc-message', event => {
      document.getElementById('selectorForAssistant').value = event.channel;
      webview.send("from-webview", "this message is from webview");
    })

    webview.addEventListener('dom-ready', () => {
      webview.openDevTools()
    })

    webview.addEventListener('did-finish-load', () => {
      webview.insertCSS(".hintBox { background-color: yellow; }");
    })

   handleFormSubmission = () => {
    const inputSelectorValue = document.getElementById("selectorForAssistant").value;
    console.log("inputSelectorValue is", inputSelectorValue);
    webview.send("selector-search", inputSelectorValue );
   }

  }
</script>

</html>

